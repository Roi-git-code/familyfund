<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Family Saving Fund</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
</head>
<body class="bg-light">

<!-- Flash messages container -->
<div class="container position-fixed top-0 end-0 p-3" style="z-index: 1055;">
  <% if (flash && flash.success) { %>
    <div class="alert alert-success alert-dismissible fade show shadow" role="alert">
      <%= flash.success[0] %>
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
  <% } %>
  <% if (flash && flash.error) { %>
    <div class="alert alert-danger alert-dismissible fade show shadow" role="alert">
      <%= flash.error[0] %>
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
  <% } %>
</div>

<!-- Header -->
<header class="bg-primary text-white text-center py-5 mb-3">
  <div class="container">
    <h1 class="fw-bold">Family Saving Fund</h1>
    <p class="lead">Empowering Families Through Collective Support</p>
  </div>
</header>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
  <div class="container">
    <a class="navbar-brand fw-bold" href="#">FamilyFund</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="mainNav">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item"><a class="nav-link" href="#about">About Us</a></li>
        <li class="nav-item"><a class="nav-link" href="#emergencies">Emergencies</a></li>
        <li class="nav-item"><a class="nav-link" href="#contribution">Contribution</a></li>
        <li class="nav-item"><a class="nav-link" href="#benefits">Benefits</a></li>
        <li class="nav-item"><a class="nav-link" href="/oma/home">OMA (Apply Online)</a></li>
        <% if (!user) { %>
          <li class="nav-item"><a class="nav-link" href="/auth">Login / Sign Up</a></li>
        <% } else { %>
          <li class="nav-item"><a class="nav-link" href="/auth/logout">Logout</a></li>
        <% } %>
      </ul>
    </div>
  </div>
</nav>

<!-- Main Content -->
<main class="container my-4">

  <% if (user) { %>
    <div class="alert alert-info text-center">
      Logged in as <strong><%= user.username %></strong> (<%= user.role.replace('_', ' ') %>)
    </div>
  <% } %>

  <!-- About -->
  <section id="about" class="mb-5">
    <h2 class="text-primary mb-3">About Us</h2>
    <p>The Family Saving Fund is a dedicated initiative designed to help families navigate social and financial emergencies through mutual support and trust...</p>
  </section>

  <!-- Emergencies -->
  <section id="emergencies" class="mb-5">
    <h2 class="text-primary mb-3">Types of Emergencies</h2>
    <ul class="list-group">
      <li class="list-group-item"><strong>Level A (Very Serious):</strong> Major surgery, funerals, severe accidents.</li>
      <li class="list-group-item"><strong>Level B (Moderate):</strong> Hospitalization, short-term challenges.</li>
      <li class="list-group-item"><strong>Level C (Minor):</strong> Routine medical care, urgent school needs.</li>
    </ul>
  </section>

  <!-- Contribution -->
  <section id="contribution" class="mb-5">
    <h2 class="text-primary mb-3">Contribution</h2>
    <p>Monthly contribution: <strong>Tsh 10,000</strong> (minimum)</p>
    <p>Funds are transferred electronically via bank or mobile money (e.g., M-Pesa, HaloPesa).</p>
    <p>Allocation of savings:</p>
    <ul class="list-group">
      <li class="list-group-item">60% - Emergency assistance</li>
      <li class="list-group-item">30% - Future reserve</li>
      <li class="list-group-item">10% - Fund operations</li>
    </ul>
  </section>

  <!-- Benefits -->
  <section id="benefits" class="mb-5">
    <h2 class="text-primary mb-3">How to Benefit</h2>
    <p>Members are eligible after six (6) months of contributions.</p>
    <ul class="list-group">
      <li class="list-group-item">Full contributors can receive up to 25% of the emergency fund balance.</li>
      <li class="list-group-item">Partial contributors receive up to 25% of their contribution ratio.</li>
    </ul>
    <p class="mt-2">Assistance decisions are made through a voting committee based on urgency, need, and contribution.</p>
  </section>

  <!-- Buttons -->
  <div class="text-center my-4">
    <% if (user?.role === 'chairman') { %>
      <a href="/member/form" class="btn btn-primary m-2">Register Member</a>
      <a href="/member" class="btn btn-outline-primary m-2">View Registered Member</a>
    <% } %>

    <% if (['chairman', 'chief_signatory', 'assistant_signatory'].includes(user?.role)) { %>
      <a href="/contributions" class="btn btn-success m-2">View Contributions</a>
    <% } %>

    <% if (user?.role === 'chief_signatory') { %>
      <a href="/contributions/form" class="btn btn-warning m-2">Add Member Contribution</a>
    <% } %>
  </div>
</main>

<!-- Footer -->
<footer class="bg-primary text-white text-center py-3 mt-4">
  &copy; <%= new Date().getFullYear() %> Family Saving Fund. All rights reserved.
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
